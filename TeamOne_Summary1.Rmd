---
title: "Key Risk Factors of Heart Disease in 2020"
author: "Team One"
date: April 4, 2022
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```
#Introduction 

According to the Center for Disease Control and Prevention (CDC), cardiovascular or heart diseases account for 1 in every 4 deaths in the United States annually. The estimated costs to the nation’s economy amount to about $363 billion annually, which include hospitalizations, after services health care needs as well as lost productivity due to death and disability (SS Virani, 2021).  The CDC also states that given the lifestyle habits of an average American, about half of the population (47%) are reported to have “1 of the 3 key risk factors for heart disease: high blood pressure, high cholesterol, and smoking”. However, the risk factors for developing heart diseases are vast and diverse and tend to vary between most racial and ethnic groups in the United States. 

Therefore, there is an immediate need to detect the major risk factors early on, so that a wellness-oriented healthcare system can be instituted. Ideally, such a system would assess the intensity of the risk factors (compared to a baseline) and focus efforts on preventing the occurrence of developing heart diseases in the first place rather than minimizing second occurrences (Liau et al, 2010; Giampaoli et al, 2005 ). 

The beginnings of the current understanding of the interconnected role of risk factors was first discussed in the Framingham Heart Study. Started in 1948, the study’s original goal was “ to identify common factors or characteristics that contribute to cardiovascular disease” (Hong 2018). However, today the FHS has morphed into a multigenerational study gathering genetic information that help analyze family patterns of certain diseases, including cardiovascular ailments (National Heart, Lung and Blood Institute). Jumping off from this, current research in the field has focused on using precision medicine algorithms along with computational development technology to assess a patient’s likelihood of developing heart disease given certain lifestyle factors. Most of the studies have focused largely on Caucasian individuals as a sample and indicating that there is a gap in the usefulness of current risk assessment tools working for individuals of differenet races. 

In this paper, we aim to understand the different risk factors that affect the occurrence of heart diseases in the US population, so that we may be able to see some of the intermingling between different risk factors.   

#Description of Dataset

The original data set can be retrieved from the CDC’s Behavioral Risk Factor Surveillance System (BRFSS) annual health survey. The survey interviews over four hundred thousand individuals in the USA asking questions regarding the risk factors of heart disease. Conducted in 2020 (published on February 15, 2020), the original data set has been cleaned from its original 300 variables to 18 variables by Kamil Pytlak and can be accessed on Kaggle . 

*** Table with variable names****


```{r}
# Lets load the appropriate libraries
library(tidyverse)
library(dplyr)
library(funModeling)
library(ezids)
library(ggplot2)
library(ggcorrplot)
library(corrr)
library(corrplot)

# Load the Data 
heart <-read.csv("heart_2020_cleaned.csv")
nrow (heart)
```


# Descrpitive Statistics  
```{r}
status (heart)
```

From the table we can see that physical and mental health have a higher percentage of zeros. This means that just over 70% of the people in our data set are report physically sick in a 30 day period while about 60% of the respondents report feeling mentally unwell in that same time period.  

We can also see that there are no N/A values in our data set. This is not surprising given that our data was cleaned before being retrieved.  


```{r }
# Finding the mean of numerical variables grouped by heart disease
plot_num(heart)

heart %>%
  group_by(HeartDisease) %>%
  summarise_at(vars("BMI", 
                    "PhysicalHealth", 
                    "MentalHealth",
                    "SleepTime"), mean)
```

On average, people with heart disease have a slightly higher BMI than those who don't have heart disease. However, the biggest difference is the number of days that a respondent feels physically unwell. Respondents who have heart disease reported feeling physically unwell about 8 days per month, while healthy people felt unwell for only 3. Poor mental health in a 30 day period is slightly higher for people with heart disease, than for people without. 

# Frequency distributions of all our categorical variables 
```{r}
freq(heart)
```


# Changing Diabetes bordeline and pregnancy categories to Yes/No
```{r}
heart$Diabetic<- replace (heart$Diabetic, heart$Diabetic== "No, borderline diabetes" , "Yes")
heart$Diabetic[heart$Diabetic== "Yes (during pregnancy)"] <- "No"  
```


#Checking if diabetic has been changed 
```{r}
describe (heart$Diabetic)
freq(heart$Diabetic)
```

# Changing all the categorical variables to numerical dummies 
```{r}
heart$HeartDisease<-ifelse(heart$HeartDisease=="Yes",1,0)
heart$Smoking<-ifelse(heart$Smoking=="Yes",1,0)
heart$AlcoholDrinking<-ifelse(heart$AlcoholDrinking=="Yes",1,0)
heart$Stroke<-ifelse(heart$Stroke=="Yes",1,0)
heart$DiffWalking<-ifelse(heart$DiffWalking=="Yes",1,0)
heart$PhysicalActivity<-ifelse(heart$PhysicalActivity=="Yes",1,0)
heart$KidneyDisease<-ifelse(heart$KidneyDisease=="Yes",1,0)
heart$SkinCancer<-ifelse(heart$SkinCancer=="Yes",1,0)
heart$Diabetic<-ifelse(heart$Diabetic=="Yes",1,0)
heart$Asthma<-ifelse(heart$Asthma=="Yes",1,0)
```

#Correlation Plots of all variables
```{r}
 model.matrix(~0+., data=heart) %>% 
     cor(use="pairwise.complete.obs") %>% 
   ggcorrplot(show.diag = F, type="upper", lab=TRUE, lab_size=2)
```


## Gender and Lifestyle

According to Noel Bairey Merz, MD, director of the Barbra Streisand Women’s Heart Center in the Smidt Heart Institute, women experience heart disease more severely than men.  Meaning that even though men are more likely to suffer heart attacks, women are more likely to die from a heart attack than a man. 

We started off by trying to see which gender tends to have more heart disease based on certain lifestyle choices.  From the table below, we can see that we have a lot more data for people without heart disease than with. However, even in the percentage table for those who do have heart disease, we see that there are more men with heart disease (about 5%) compared to women (3%). This is in line with our basic theory that men have more heart disease.  However, we are then forced to ask why do men have more heart disease in our sample? Are they doing more or less of a certain activity than their female counterparts? Discussions of the relevant variables are provided below. 


# Contingency Table for Sex & Heart Disease 

```{r}

contable = table(heart$HeartDisease, heart$Sex)
xkabledply(contable, title="Contingency Table for heart Disease and Sex")
addmargins(contable)

prop <-prop.table(contable)
percent <- round(prop*100, 2)

print ("Contingency Table for heart Disease and Sex in Percentage")
print (percent)
barplot(with(heart, table(HeartDisease, Sex)), main="heart Disease & Sex", beside=T, col=3:2)
```


However, we are then forced to ask why do men have more heart disease in our sample? Are they doing more or less of a certain activity than their female counterparts?   

In our exploratory analysis, we compared the different lifestyle variables between men and women and then further compared those same variables between those with and without heart disease. 


##Body Mass Index (BMI)

# Is there a difference between the mean BMI of men and woman in the overall population? 

```{r}
hist(heart$BMI)
```

In the historgram, we can see that our data is approximately normal and given the Central Limit Theorem, if n>30, then we can assume normality for the sake of statistical tests.

After sub-setting the data between male and female, we conducted a Welch's t-test on the BMIs of both population subsets. 

```{r}
# Subset Male & Female with and without Heart Disease
female <- subset(heart, Sex== "Female")
male  <- subset (heart, Sex == "Male")

# T-test of BMI between Genders 
t.test(female$BMI, male$BMI)
```

The p-value is less than 5% significance level, allowing us to reject the null hypothesis and conclude that the overall average BMI is different between the male and female populations. From the mean values, we see that men have a mean BMI of 28.50 while women have a BMI of 28.16. A difference of 0.34.  

Next, we divided our data frame between men and women who do have heart disease. Once again assuming normality due to the large sample size, we conducted another Welch's T-test to look at the mean BMI difference. 

# Is there a difference in average BMI between the sexes with heart disease?

```{r}
# Subsetting genders based on respondents that have heart disease 
HD <- subset(heart, HeartDisease==1)
female_HD<- subset(female, HeartDisease==1)
male_HD<- subset(male, HeartDisease== 1)

#T-Test
t.test(female_HD$BMI, male_HD$BMI)
                  
 
```

From the T-test output above, we see that the p-value is 0.604, which is greater than 0.05. This means that we fail to reject the null and conclude that there is no significant difference in the average BMI between men and women who do have heart disease. 


#Physical Health 
# How many times in the last 30 days have you felt physically ill? 

Earlier, we saw that respondents, who have heart disease, reported feeling physically unwell about 8 days per month, while healthy people felt unwell for only 3. The boxplot below, shows us that women with heart disease generally report felling unwell more than men. 

```{r}
ggplot(heart, aes(x = factor(HeartDisease), y = PhysicalHealth))+
    geom_boxplot(aes(fill = Sex))+
    xlab('HeartDisease') + 
    scale_fill_brewer(palette = 'Set1', name = 'Sex')
```

```{r}
t.test(male_HD$PhysicalHealth, 
       female_HD$PhysicalHealth)
```

The t-test also confirms what the boxplot is showing. Since the p-value is less than 5%, that there is a difference in the number of days that men and women feel unwell. On average, women reported feeling sick about 9 days while men reported just over 6 days. 


#Mental Health 
```{r}
ggplot(heart, aes(x = factor(HeartDisease), y = MentalHealth))+
    geom_boxplot(aes(fill = Sex))+
    xlab('HeartDisease') + 
    scale_fill_brewer(palette = 'Set1', name = 'Sex')

t.test  (male_HD$MentalHealth, 
       female_HD$MentalHealth)
```

The boxplot shows that women tend to report feeling mentally unwell more often then men.Since the p-value is less than 5%, that there is a difference in the number of days that men and women feel mentally unwell. On average, women reported feeling mentally unwell twice as many days as men.

# Sleep
#On average,how many hours of sleep do you get in a 24-hour period?
```{r}
ggplot(heart, aes(x = factor(HeartDisease), y = SleepTime))+
    geom_boxplot(aes(fill = Sex))+
    xlab('HeartDisease') + 
    scale_fill_brewer(palette = 'Set1', name = 'Sex')

t.test  (male_HD$SleepTime, 
       female_HD$SleepTime)
```

Men and women have statistically diffeent sleep times. Men on average get about 35 more minutes of sleep a week than women. This may not sound like much but sleep is cumulative.According to Dr.Rebecca Robbins,  sleep expert and postdoctoral researcher at the Brigham and Women’s Hospital and Harvard Medical School,Dr. Robbins conducted research that examined a group of people who got the recommended seven to eight hours of sleep a night to those who got less (even just 30 minutes less), and exposed them to a norovirus.

"We see experimentally when we curtail sleep below the recommended seven hours that risk for viral infection goes up many fold—nearly four times higher among those who are sleeping poorly or getting insufficient sleep, compared to those who are getting good rest,"

https://www.wellandgood.com/benefits-of-getting-more-sleep/

This lack of sleep could explain why women report feeling physically unwell more days in a month than men. 

When looking at other lifestyle factors such as smoking or alcohol drinking, we see that there is no statistical difference that can be measured between the sexes and those that have heart disease. Remember people lie. 

# Age, Race, Gen Health
```{r}
freq(HD$AgeCategory)
freq(HD$Race)
freq(HD$GenHealth)

```

We looking at the population make-up respondents who do have heart, we see that a higher percentage of respondents are 60 and older, with 82% being of caucasian descent. At the time of the intervoew they also said they felt their overall health is good. 

# Liner Regression on Sex 
```{r}
reg_1 <- lm(HeartDisease~Sex+BMI+ PhysicalHealth+MentalHealth, data=heart)
summary (reg_1)

reg_2 <- lm(HeartDisease~Sex+BMI+ PhysicalHealth+MentalHealth + SleepTime, data=heart)
summary (reg_2)

reg_3 <- lm(HeartDisease~Sex+BMI+ PhysicalHealth+MentalHealth + SleepTime +AgeCategory + Race, data=heart)
summary (reg_3)
```

Adjusted r-square is increasing so definitely model fit is improving but still not a good fit 


###########################################################################################

# heart Disease & Secondary Illnesses 
In this part we are Identifying whether heartDisease and secondary illnesses have correlation or not(are they dependent or independent?).
# Correlation matrix among diseases 

```{r}
diseases <- data.frame (heart$HeartDisease,
                        heart$Stroke,
                        heart$Diabetic,
                        heart$Asthma, 
                        heart$KidneyDisease,
                        heart$SkinCancer)

# Rename columns

names(diseases) <- c ('heart_disease',
                      'stroke',
                      'diabetic',
                      'asthma',
                      'kidney_disease',
                      'skin_cancer')


```

# Corellation  Matrix between diseases
```{r}
model.matrix(~0+., data=diseases) %>% 
     cor(use="pairwise.complete.obs") %>% 
    ggcorrplot(show.diag = F, type="upper", lab=TRUE, lab_size=2)

```

Correlations not particularly strong 
heart disease and stroke seem correlated
Diabetes is correlated with heart disease and Kidney disease. Less with Stroke.
Skin cancer is not correlated with other  diseases.

# Determining Independence between Diseases
```{r}
hea_as=table(heart$HeartDisease,heart$Asthma)
chi_1=chisq.test(hea_as)
chi_1

hea_dia=table(heart$HeartDisease,heart$Diabetic)
chi_2=chisq.test(hea_dia)
chi_2

hea_kid=table(heart$HeartDisease,heart$KidneyDisease)
chi_3=chisq.test(hea_kid)
chi_3

hea_skin=table(heart$HeartDisease,heart$SkinCancer)
chi_4=chisq.test(hea_skin)
chi_4

hea_stroke=table(heart$HeartDisease,heart$Stroke)
chi_5=chisq.test(hea_stroke)
chi_5
```

For all the chi^2 tests we performed above, the p-value<0.05. So all the above rejects null hypothesis. 
Every secondary illness (Diabetic,Asthma, Kidney disease and skin cancer) has a relationship with heart Disease. 


# Smokers Vs Drinkers 

First of all does smoking and drinking cause heart attack or heart disease?

Yes, it is actually one among the reason that can cause heart disease in young people and majority of cases are seen in women according to a most of the publishes articles and researchers.

To determine if there is a link between heart disease and drug use, researchers investigated and discovered that recreational use of nicotine, cannabis, alcohol, and illegal substances such as amphetamine and cocaine may be linked to prematurely clogged arteries.Premature heart disease can arise before the age of 65 in women and 55 in males, and it can be difficult and dangerous.

According to statistics from the countrywide veterans affairs healthcare and veterans with premaTure AtheroscLerosis (VITAL) registry (2014-2015). There are 7716 patients who are having extremely premature heart disease , and they discovered this by comparing them to those who do not have premature heart disease.

According to the study and analysis, patients with early heart disease are more likely to smoke (63 percent versus 41 percent) and drink alcohol (32 percent vs 15 percent )

```{r}
contable_smoke = table(heart$HeartDisease, heart$Smoking)

prop <-prop.table(contable_smoke)
percent <- round(prop*100, 2)

xkabledply(percent, title="Contingency Table for heart Disease and Smoking in Percentage")
```

How does Smoking and Drinking is the cause?

The interaction between the tobacco(smoking) and alcohol can lead to heart problems and it depends on some factors in which we can find out.
Initially, It might depend upon quantity of dose the person is consuming it.
And based on some research I found that consuming alcohol in range of  3 to 14 drinks per week is prone to lower risk of heart attack but there are other risks factors that lead to complex issues like blockage in artery and deficiency in blood flow or it can lead to heart failure.

When looked at the cause for smoking there is a high change of risk leading to heart problems.  Some heart failures caused by smoking are stroke, bleeding from brain and congestion in chest.

Does people who Drink smoke?

Some researchers have found that among people who drink have  high changes of smoking most of the times. 


```{r}

contable_drink = table(heart$HeartDisease, heart$AlcoholDrinking)

prop <-prop.table(contable_drink)
percent <- round(prop*100, 2)

xkabledply(percent, title="Contingency Table for heart Disease and Drinking in Percentage")

```
What is the relation between smoking and heart disease ?

So, basically people who tend to smoke have issues related to cardiovascular disease(CVD). CVD occurs when chemicals in cigarettes release then the blood becomes thick and starts forming clots inside veins and arteries. When the blood vessel are completely blocked then it can lead to heart attack and sudden death. Which can lead to death of the person. In the United States, there were reportedly 800,000 people who faced cardiovascular disease and was the mere cause of death in which 8million died of heart attack and other 7 million died of stroke.

When measured on how many cigarettes people consume leads to health issues there is 100 percent chance that people’s health will be damaged no matter if they consumed one or two per day. The fact that when people consume one to two cigarettes may show signs of CVD but gradually they might face problems. Another risk factor is that if people consume more than 5 cigarettes a day they may show signs of early CVD. Based on this we can imagine that the risk of CVD increases based on the number of cigarettes consumed per day. 

How is smoking Effecting?

When a person smoke the chemicals substances in the cigarette cause the cells of boodle vessels stolen and inflamed which leads to blood vessels becoming narrow. 

What is the relation between Drinking and heart disease ?

When a person has a habit to drink than to indicate that his health is getting damaged then we have to understand what is the percentage of alcohol being consumed per day and we can weight it in grams/units. On an average the standard practice of people who drink consume 12 to 15grams off alcohol. Based on this practice there are most often low and high risks. Low risk or moderate risk has an average of 1 to 2 drinks per day and high risk can be measured on consuming more than 4 drinks per day.
```{r chisq}

chisq.test(contable_smoke)

chisq.test(contable_drink)

```
```
For both the chi^2 tests we performed above, the p-value<0.05. So all the above rejects null hypothesis. 
Both drinking and smoking have a relationship with heart Disease. 